{"version":3,"file":"commonHelpers.js","sources":["../src/img/edit.svg","../src/js/default-sw.js"],"sourcesContent":["export default \"__VITE_ASSET__81a4ab51__\"","import * as FirebaseApi from './firebase-api';\nimport { refs } from './refs';\nimport { nanoid } from 'nanoid';\nimport { checkLogin, getName, getTask, logOut, onBack } from './utilites';\nimport editIcon from '../img/edit.svg';\nimport { onErrorToast } from './utilites';\n\ncheckLogin();\ncheckTask();\n\nFirebaseApi.checkIsBusy('default_stopwatch_1');\nFirebaseApi.checkUser('default_stopwatch_1');\n\nsetInterval(() => {\n  const data = FirebaseApi.getIsBusy();\n  const user = JSON.parse(localStorage.getItem('log')).user;\n\n  if (data.user !== localUser) {\n    location.reload();\n    return;\n  }\n\n  FirebaseApi.setIsBusy('default_stopwatch_1', {\n    lastTime: Date.now(),\n    user: user,\n    isBusy: true,\n  });\n}, 5000);\n\nFirebaseApi.checkIsBusy('default_stopwatch_1');\n\nrefs.backBtn.addEventListener('click', onBack);\nrefs.logOutBtn.addEventListener('click', logOut);\nrefs.startBtn.addEventListener('click', onStart);\nrefs.stopBtn.addEventListener('click', onStop);\nrefs.stepsList.addEventListener('click', onDelete);\nrefs.resetBtn.addEventListener('click', onReset);\nrefs.resetBackdrop.addEventListener('click', onDecideReset);\nrefs.taskInput.addEventListener('input', () => {\n  refs.taskInput.classList.remove('task-input-required');\n});\nrefs.taskForm.addEventListener('submit', onSaveTask);\n\nrefs.navName.innerHTML = JSON.parse(localStorage.getItem('log')).user;\n\nFirebaseApi.checkDefaultData();\nFirebaseApi.checkDefaultList();\n\nasync function onStart() {\n  if (!localStorage.getItem('task')) {\n    refs.taskInput.classList.add('task-input-required');\n    onErrorToast('Please, enter the task', '#task');\n    return;\n  }\n\n  const startDate = Date.now();\n\n  const data = await FirebaseApi.getDefaultData();\n  refs.taskInput.classList.remove('task-input-required');\n\n  FirebaseApi.setDefaultData({\n    ...data,\n    isStart: true,\n    start: startDate,\n  });\n}\n\nasync function onStop() {\n  const stopDate = Date.now();\n\n  const data = await FirebaseApi.getDefaultData();\n  const stepsList = await FirebaseApi.getDefaultStepsList();\n\n  const stepNum = stepsList.items.length > 0 ? stepsList.items.length + 1 : 1;\n  const time = stopDate - data.start;\n  const task = localStorage.getItem('task');\n  const user = JSON.parse(localStorage.getItem('log')).user;\n\n  const newStepItem = {\n    id: nanoid(),\n    step: stepNum,\n    time: time,\n    user: user,\n    task: task,\n  };\n\n  FirebaseApi.addDefaultStepToList(newStepItem);\n\n  FirebaseApi.setDefaultData({\n    ...data,\n    isStart: false,\n    stop: stopDate,\n  });\n}\n\nasync function onDelete(e) {\n  if (e.target.nodeName !== 'BUTTON') {\n    return;\n  }\n\n  FirebaseApi.deleteDefaultStepById(e.target.id);\n}\n\nfunction onReset() {\n  refs.resetBackdrop.classList.remove('visually-hidden');\n  document.querySelector('body').style.overflow = 'hidden';\n  document.addEventListener('keydown', closeModalByEsc);\n}\n\nfunction onDecideReset(e) {\n  if (\n    e.target.classList.contains('no-btn') ||\n    e.target.classList.contains('backdrop')\n  ) {\n    refs.resetBackdrop.classList.add('visually-hidden');\n  } else if (e.target.classList.contains('yes-btn')) {\n    FirebaseApi.resetDefaultStepList();\n    refs.resetBackdrop.classList.add('visually-hidden');\n  }\n  document.querySelector('body').style.overflow = 'visible';\n  document.removeEventListener('keydown', closeModalByEsc);\n  return;\n}\n\nfunction closeModalByEsc(e) {\n  if (e.code !== 'Escape') return;\n  refs.resetBackdrop.classList.add('visually-hidden');\n  document.querySelector('body').style.overflow = 'visible';\n  document.removeEventListener('keydown', closeModalByEsc);\n}\n\nfunction onSaveTask(e) {\n  e.preventDefault();\n\n  if (!refs.taskInput.value) {\n    refs.taskInput.classList.add('task-input-required');\n    onErrorToast('Please, enter the task', '#task');\n    return;\n  }\n\n  localStorage.setItem('task', refs.taskInput.value);\n  checkTask();\n}\n\nfunction checkTask() {\n  if (!localStorage.getItem('task')) {\n    refs.username.innerHTML = `Hi ${getName()},`;\n    return;\n  }\n\n  refs.taskWrap.insertAdjacentHTML(\n    'afterbegin',\n    `<button type=\"button\" class=\"edit-btn\"><img class=\"edit-icon\" src=\"${editIcon}\"/></button>`\n  );\n  refs.taskForm.classList.add('task-form-hidden');\n  refs.username.innerHTML = `Great ${getName()}!`;\n  refs.taskFormDescription.innerHTML = `The task you'll be timing is \"${getTask()}\".`;\n  document.querySelector('.edit-btn').addEventListener('click', onEdit);\n}\n\nfunction onEdit() {\n  localStorage.removeItem('task');\n  document.querySelector('.edit-btn').remove();\n  refs.taskForm.classList.remove('task-form-hidden');\n  refs.username.innerHTML = `Hi ${getName()},`;\n  refs.taskFormDescription.innerHTML = `Before you begin, please enter the name of the task in the box below and click on the \"Save\" button.`;\n}\n"],"names":["editIcon","checkLogin","checkTask","FirebaseApi.checkIsBusy","FirebaseApi.checkUser","data","FirebaseApi.getIsBusy","user","FirebaseApi.setIsBusy","refs","onBack","logOut","onStart","onStop","onDelete","onReset","onDecideReset","onSaveTask","FirebaseApi.checkDefaultData","FirebaseApi.checkDefaultList","onErrorToast","startDate","FirebaseApi.getDefaultData","FirebaseApi.setDefaultData","stopDate","stepsList","FirebaseApi.getDefaultStepsList","stepNum","time","task","newStepItem","nanoid","FirebaseApi.addDefaultStepToList","FirebaseApi.deleteDefaultStepById","closeModalByEsc","FirebaseApi.resetDefaultStepList","getName","getTask","onEdit"],"mappings":"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"}