{"version":3,"file":"commonHelpers3.js","sources":["../src/js/login.js"],"sourcesContent":["import { getUsers } from './firebase-api';\nimport { refs } from './refs';\nimport { onErrorToast } from './utilites';\n\nrefs.loginForm.addEventListener('submit', onLogin);\nrefs.loginInput.addEventListener('input', () => {\n  refs.loginInput.classList.remove('login-input-required');\n});\n\nasync function onLogin(e) {\n  e.preventDefault();\n\n  if (!refs.loginInput.value) {\n    onErrorToast('Please, entrer a token', '#');\n    refs.loginInput.classList.add('login-input-required');\n    return;\n  }\n\n  const users = await getUsers();\n  const token = refs.loginInput.value;\n\n  let isTokenTrue = false;\n  let userData;\n\n  for (let user of users) {\n    if (user.token === token) {\n      isTokenTrue = true;\n      userData = user;\n      break;\n    }\n  }\n\n  if (!isTokenTrue) {\n    refs.loginInput.classList.add('login-input-required');\n    onErrorToast('Wrong token', '#');\n  } else {\n    refs.loginInput.classList.remove('login-input-required');\n    localStorage.setItem(\n      'log',\n      JSON.stringify({ ...userData, logIn: Date.now() })\n    );\n    arr = location.pathname.split('/');\n    location.pathname = `/${arr[0]}`;\n  }\n}\n"],"names":["refs","onLogin","e","onErrorToast","users","getUsers","token","isTokenTrue","userData","user"],"mappings":"+IAIAA,EAAK,UAAU,iBAAiB,SAAUC,CAAO,EACjDD,EAAK,WAAW,iBAAiB,QAAS,IAAM,CAC9CA,EAAK,WAAW,UAAU,OAAO,sBAAsB,CACzD,CAAC,EAED,eAAeC,EAAQC,EAAG,CAGxB,GAFAA,EAAE,eAAc,EAEZ,CAACF,EAAK,WAAW,MAAO,CAC1BG,EAAa,yBAA0B,GAAG,EAC1CH,EAAK,WAAW,UAAU,IAAI,sBAAsB,EACpD,MACD,CAED,MAAMI,EAAQ,MAAMC,IACdC,EAAQN,EAAK,WAAW,MAE9B,IAAIO,EAAc,GACdC,EAEJ,QAASC,KAAQL,EACf,GAAIK,EAAK,QAAUH,EAAO,CACxBC,EAAc,GACdC,EAAWC,EACX,KACD,CAGEF,GAIHP,EAAK,WAAW,UAAU,OAAO,sBAAsB,EACvD,aAAa,QACX,MACA,KAAK,UAAU,CAAE,GAAGQ,EAAU,MAAO,KAAK,IAAG,EAAI,CACvD,EACI,IAAM,SAAS,SAAS,MAAM,GAAG,EACjC,SAAS,SAAW,IAAI,IAAI,CAAC,CAAC,KAT9BR,EAAK,WAAW,UAAU,IAAI,sBAAsB,EACpDG,EAAa,cAAe,GAAG,EAUnC"}