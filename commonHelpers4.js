import{f as d,r as e,c as I,o as B,h as b,a as m,i as c,j as n,g,k}from"./assets/refs-045b35db.js";import{k as S,i as T,l as v}from"./assets/firebase-api-d51a0bbf.js";import{n as f}from"./assets/vendor-451a0b16.js";function L(t){return t.map(s=>`<li class="process-item">
                <p class="process-item-name">
                  ${s.name}
                </p>
              </li>`).join("")}const w=t=>{const s=t.map(o=>`
    <li class="process-list-item">
    <div>
    <div class="step-time-item">
        <div>
          <p class="step">Step ${o.step}</p>
          <p class="time">${d(o.time).minutes}:${d(o.time).secunds},${d(o.time).milisecunds}</p>
        </div>
    </div>
    <div class="step-description">
      <div class="step-task">
        <p>${o.task}</p>
      </div>
    </div>
    </div>
    </li>
  `).join("");e.stepsList.innerHTML=s};function P(t){return t.map(s=>`
    <li class="total-list-item">
          <p class="total-list-title">${s.process}</p>
          <ul class="total-list-tasks">
            ${s.items.map(o=>`
                <li class="total-list-tasks-item">
              <div class="total-task">
                <p class="total-list-tasks-step">${o.step}.</p>
                <p class="total-list-tasks-task">${o.task}</p>
              </div>
              <p class="total-list-tasks-time">
                ${d(o.time).minutes}:${d(o.time).secunds},${d(o.time).milisecunds}
              </p>
            </li>
            `).join("")}
          </ul>
          <button id="${s.id}" type="button" class="total-list-item-delete">Delete</button>
        </li>
    `).join("")}let i;e.sectionList.getBoundingClientRect().top;localStorage.getItem("processes")||localStorage.setItem("processes","[]");localStorage.getItem("allProcesses")||localStorage.setItem("allProcesses","[]");I();l();document.addEventListener("click",y);e.backBtn.addEventListener("click",B);e.processInput.addEventListener("focus",y);e.processInput.addEventListener("input",()=>b(J,500));e.processList.addEventListener("click",N);e.taskForm.addEventListener("submit",O);e.startBtn.addEventListener("click",E);e.pauseBtn.addEventListener("click",H);e.resumeBtn.addEventListener("click",$);e.lapBtn.addEventListener("click",M);e.stopBtn.addEventListener("click",F);e.sendBtn.addEventListener("click",j);e.showListBtn.addEventListener("click",x);document.querySelector(".send-btn-wrap").addEventListener("click",K);window.addEventListener("scroll",D);e.deleteTotalBtn[0]&&e.totalList.addEventListener("click",W);e.navName.innerHTML=JSON.parse(localStorage.getItem("log")).user;async function y(){const t=await S();e.processList.innerHTML=L(t),e.processInput===document.activeElement?(e.taskForm.style.overflow="visible",e.processList.classList.remove("visually-hidden")):(e.taskForm.style.overflow="hidden",e.processList.classList.add("visually-hidden"))}function N(t){const s=t.target.textContent.trim();e.processInput.value=s}async function J(){const t=e.processInput.value,o=(await S()).filter(r=>r.name.toLowerCase().includes(t.toLowerCase())),a=L(o);e.processList.innerHTML=a}async function O(t){t.preventDefault();const s=e.processInput.value,a=(await S()).find(r=>r.name===s);a?localStorage.setItem("process",JSON.stringify(a)):m("Please, choose a process from list.","#"),c(e.startBtn),l()}function D(){const t=window.scrollY;e.processesSaveBtn&&t>=200?e.processesSaveBtn.classList.remove("button-hidden"):e.processesSaveBtn.classList.add("button-hidden")}function l(){const t=JSON.parse(localStorage.getItem("process")),s=JSON.parse(localStorage.getItem("processes")),o=JSON.parse(localStorage.getItem("allProcesses"));if(w(s),o.length<=0?(e.totalList.innerHTML='<p class="empty-message">List is empty</p>',e.sendBtnWrap.innerHTML="",document.querySelector(".total-quantity").classList.add("visually-hidden"),document.querySelector(".total-quantity-number").innerHTML=0):(e.totalList.innerHTML=P(o),e.sendBtnWrap.innerHTML='<button class="send-total-btn active-btn">Send</button>',document.querySelector(".total-quantity").classList.remove("visually-hidden"),document.querySelector(".total-quantity-number").innerHTML=o.length),!t){clearInterval(i),e.taskForm.classList.remove("task-form-hidden"),n(e.startBtn),n(e.lapBtn),n(e.stopBtn),e.username.innerHTML=`Hi ${g()},`,e.taskFormDescription.innerHTML='Before you begin, please enter the name of the task in the box below and click on the "Save" button.';return}if(e.editWrap.innerHTML=`<button type="button" class="edit-btn"><img class="edit-icon" src="${T}"/></button>`,document.querySelector(".edit-btn").disabled=!0,document.querySelector(".edit-btn").style.visibility="hidden",t.startDate&&!i&&!t.onPause?(i=setInterval(()=>{const a=Date.now()-t.startDate;v(a)},10),c(e.pauseBtn),n(e.startBtn),c(e.lapBtn),c(e.stopBtn)):t.startDate||(n(e.pauseBtn),n(e.lapBtn),n(e.stopBtn),c(e.startBtn),document.querySelector(".edit-btn").disabled=!1,document.querySelector(".edit-btn").style.visibility="visible"),t.onPause&&(clearInterval(i),i=null,c(e.resumeBtn),n(e.pauseBtn),n(e.stopBtn),n(e.startBtn),n(e.lapBtn)),e.taskForm.classList.add("task-form-hidden"),e.username.innerHTML=`Great ${g()}!`,e.taskFormDescription.innerHTML=`The process you'll be timing is "${k().name}".`,document.querySelector(".edit-btn").addEventListener("click",q),document.querySelector(".list-btns-processes").classList.remove("btns-list-visible"),s.length>=t.steps.length){clearInterval(i);const a=JSON.parse(localStorage.getItem("process"));delete a.startDate,localStorage.setItem("process",JSON.stringify(a)),document.querySelector(".list-btns-processes").classList.add("btns-list-visible"),n(e.startBtn),n(e.pauseBtn),n(e.resumeBtn),n(e.lapBtn),c(e.stopBtn)}}function q(){localStorage.removeItem("process"),document.querySelector(".edit-btn").remove(),localStorage.setItem("processes","[]"),l()}function E(){const t=JSON.parse(localStorage.getItem("process"));if(!t){e.taskInput.classList.add("task-input-required"),m("Please, enter the task","#task");return}t.onPause=!1;const s=Date.now();t.startDate=s,localStorage.setItem("process",JSON.stringify(t)),l()}function H(){const t=JSON.parse(localStorage.getItem("process"));t.onPause=!0;const s=Date.now();t.pauseDate=s,localStorage.setItem("process",JSON.stringify(t)),l()}function $(){const t=JSON.parse(localStorage.getItem("process")),s=JSON.parse(localStorage.getItem("processes")),o=s.length,a=t.startDate,r=t.pauseDate,p=Date.now(),u=p-(r-a);if(o>0){const h=p-r;s[o-1].currentTime+=h,localStorage.setItem("processes",JSON.stringify(s))}t.startDate=u,t.onPause=!1,delete t.pauseDate,localStorage.setItem("process",JSON.stringify(t)),n(e.resumeBtn),c(e.pauseBtn),c(e.stopBtn),c(e.lapBtn),l()}function M(){const t=JSON.parse(localStorage.getItem("process")),s=JSON.parse(localStorage.getItem("processes")),o=JSON.parse(localStorage.getItem("log"));t.onPause=!1,e.watch.classList.add("push-watch"),setTimeout(()=>{e.watch.classList.remove("push-watch")},200);const a=Date.now(),r=s.length,p=s.length>0?a-s[r-1].currentTime:a-t.startDate,u={id:f(),step:r+1,user:o.user,time:p,currentTime:a,process:t.name,task:t.steps[r]};s.push(u),localStorage.setItem("processes",JSON.stringify(s)),l()}function F(){const t=JSON.parse(localStorage.getItem("process"));t.onPause=!1,delete t.startDate,localStorage.setItem("process",JSON.stringify(t)),clearInterval(i),i=null,localStorage.setItem("processes","[]"),v(0),l()}function j(){const t=JSON.parse(localStorage.getItem("processes")),s=JSON.parse(localStorage.getItem("allProcesses")),o={id:f(),type:"process-stop-watch",process:t[0].process,items:t};s.push(o),localStorage.setItem("allProcesses",JSON.stringify(s)),localStorage.setItem("processes","[]"),clearTimeout(i),i=null,l()}function x(){document.querySelector("body").style.overflow="hidden",e.hideListBtn.addEventListener("click",C),e.listBackdrop.classList.remove("visually-hidden")}function C(){document.querySelector("body").style.overflow="visible",e.listBackdrop.classList.add("visually-hidden")}function W(t){if(t.target.nodeName!=="BUTTON")return;const s=t.target.id,a=JSON.parse(localStorage.getItem("allProcesses")).filter(r=>r.id!==s);localStorage.setItem("allProcesses",JSON.stringify(a)),setTimeout(()=>{l()},200)}async function K(){e.sendBackdrop.classList.remove("visually-hidden");const t=JSON.parse(localStorage.getItem("allProcesses")),s=[];for(let a of t)a.items.forEach(r=>s.push(r));const o={type:"process-stop-watch",items:s};document.querySelector(".send-btn-wrap").classList.add("visually-hidden");try{const a=await fetch("https://script.google.com/macros/s/AKfycbwQfPNpDsZK7s3qT5Jt8PBS7B2YnK_ILFqPV65fPhuc7J9jd8vJYz4g8oSnoR0GqPSE/exec",{method:"POST",body:JSON.stringify(o)})}catch{m("Oops. Something went wrong.","#")}finally{document.querySelector(".send-btn-wrap").classList.remove("visually-hidden"),e.sendBackdrop.classList.add("visually-hidden")}}
//# sourceMappingURL=commonHelpers4.js.map
