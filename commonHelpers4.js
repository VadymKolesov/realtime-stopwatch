import{f as d,r as e,c as h,o as B,h as I,a as p,i as c,j as n,g as m,k as b}from"./assets/refs-045b35db.js";import{l as u,j as k,m as S}from"./assets/firebase-api-1cf085c5.js";import{n as g}from"./assets/vendor-451a0b16.js";function v(t){return t.map(s=>`<li class="process-item">
                <p class="process-item-name">
                  ${s.name}
                </p>
              </li>`).join("")}const w=t=>{const s=t.map(a=>`
    <li class="process-list-item">
    <div>
    <div class="step-time-item">
        <div>
          <p class="step">Step ${a.step}</p>
          <p class="time">${d(a.time).minutes}:${d(a.time).secunds},${d(a.time).milisecunds}</p>
        </div>
    </div>
    <div class="step-description">
      <div class="step-task">
        <p>${a.task}</p>
      </div>
    </div>
    </div>
    </li>
  `).join("");e.stepsList.innerHTML=s};function T(t){return t.map(s=>`
    <li class="total-list-item">
          <p class="total-list-title">${s.process}</p>
          <ul class="total-list-tasks">
            ${s.items.map(a=>`
                <li class="total-list-tasks-item">
              <div class="total-task">
                <p class="total-list-tasks-step">${a.step}.</p>
                <p class="total-list-tasks-task">${a.task}</p>
              </div>
              <p class="total-list-tasks-time">
                ${d(a.time).minutes}:${d(a.time).secunds},${d(a.time).milisecunds}
              </p>
            </li>
            `).join("")}
          </ul>
          <button id="${s.id}" type="button" class="total-list-item-delete">Delete</button>
        </li>
    `).join("")}let i;e.sectionList.getBoundingClientRect().top;localStorage.getItem("processes")||localStorage.setItem("processes","[]");localStorage.getItem("allProcesses")||localStorage.setItem("allProcesses","[]");h();l();document.addEventListener("click",f);e.backBtn.addEventListener("click",B);e.processInput.addEventListener("focus",f);e.processInput.addEventListener("input",()=>I(N,500));e.processList.addEventListener("click",P);e.taskForm.addEventListener("submit",J);e.startBtn.addEventListener("click",q);e.pauseBtn.addEventListener("click",E);e.resumeBtn.addEventListener("click",H);e.lapBtn.addEventListener("click",$);e.stopBtn.addEventListener("click",M);e.sendBtn.addEventListener("click",F);e.showListBtn.addEventListener("click",j);document.querySelector(".send-btn-wrap").addEventListener("click",W);window.addEventListener("scroll",O);e.deleteTotalBtn[0]&&e.totalList.addEventListener("click",x);e.navName.innerHTML=JSON.parse(localStorage.getItem("log")).user;async function f(){const t=await u();e.processList.innerHTML=v(t),e.processInput===document.activeElement?(e.taskForm.style.overflow="visible",e.processList.classList.remove("visually-hidden")):(e.taskForm.style.overflow="hidden",e.processList.classList.add("visually-hidden"))}function P(t){const s=t.target.textContent.trim();e.processInput.value=s}async function N(){const t=e.processInput.value,a=(await u()).filter(r=>r.name.toLowerCase().includes(t.toLowerCase())),o=v(a);e.processList.innerHTML=o}async function J(t){t.preventDefault();const s=e.processInput.value,o=(await u()).find(r=>r.name===s);o?localStorage.setItem("process",JSON.stringify(o)):p("Please, choose a process from list.","#"),c(e.startBtn),l()}function O(){const t=window.scrollY;e.processesSaveBtn&&t>=200?e.processesSaveBtn.classList.remove("button-hidden"):e.processesSaveBtn.classList.add("button-hidden")}function l(){const t=JSON.parse(localStorage.getItem("process")),s=JSON.parse(localStorage.getItem("processes")),a=JSON.parse(localStorage.getItem("allProcesses"));if(w(s),a.length<=0?(e.totalList.innerHTML='<p class="empty-message">List is empty</p>',e.sendBtnWrap.innerHTML="",document.querySelector(".total-quantity").classList.add("visually-hidden"),document.querySelector(".total-quantity-number").innerHTML=0):(e.totalList.innerHTML=T(a),e.sendBtnWrap.innerHTML='<button class="send-total-btn active-btn">Send</button>',document.querySelector(".total-quantity").classList.remove("visually-hidden"),document.querySelector(".total-quantity-number").innerHTML=a.length),!t){clearInterval(i),e.taskForm.classList.remove("task-form-hidden"),n(e.startBtn),n(e.lapBtn),n(e.stopBtn),e.username.innerHTML=`Hi ${m()},`,e.taskFormDescription.innerHTML='Before you begin, please enter the name of the task in the box below and click on the "Save" button.';return}if(e.editWrap.innerHTML=`<button type="button" class="edit-btn"><img class="edit-icon" src="${k}"/></button>`,document.querySelector(".edit-btn").disabled=!0,document.querySelector(".edit-btn").style.visibility="hidden",t.startDate&&!i&&!t.onPause?(i=setInterval(()=>{const o=Date.now()-t.startDate;S(o)},10),c(e.pauseBtn),n(e.startBtn),c(e.lapBtn),c(e.stopBtn)):t.startDate||(n(e.pauseBtn),n(e.lapBtn),n(e.stopBtn),c(e.startBtn),document.querySelector(".edit-btn").disabled=!1,document.querySelector(".edit-btn").style.visibility="visible"),t.onPause&&(clearInterval(i),i=null,c(e.resumeBtn),n(e.pauseBtn),n(e.stopBtn),n(e.startBtn),n(e.lapBtn)),e.taskForm.classList.add("task-form-hidden"),e.username.innerHTML=`Great ${m()}!`,e.taskFormDescription.innerHTML=`The process you'll be timing is "${b().name}".`,document.querySelector(".edit-btn").addEventListener("click",D),document.querySelector(".list-btns-processes").classList.remove("btns-list-visible"),s.length>=t.steps.length){clearInterval(i);const o=JSON.parse(localStorage.getItem("process"));delete o.startDate,localStorage.setItem("process",JSON.stringify(o)),document.querySelector(".list-btns-processes").classList.add("btns-list-visible"),n(e.startBtn),n(e.pauseBtn),n(e.resumeBtn),n(e.lapBtn),c(e.stopBtn)}}function D(){localStorage.removeItem("process"),document.querySelector(".edit-btn").remove(),localStorage.setItem("processes","[]"),l()}function q(){const t=JSON.parse(localStorage.getItem("process"));if(!t){e.taskInput.classList.add("task-input-required"),p("Please, enter the task","#task");return}t.onPause=!1;const s=Date.now();t.startDate=s,localStorage.setItem("process",JSON.stringify(t)),l()}function E(){const t=JSON.parse(localStorage.getItem("process"));t.onPause=!0;const s=Date.now();t.pauseDate=s,localStorage.setItem("process",JSON.stringify(t)),l()}function H(){const t=JSON.parse(localStorage.getItem("process")),s=t.startDate,a=t.pauseDate,r=Date.now()-(a-s);t.startDate=r,t.onPause=!1,delete t.pauseDate,localStorage.setItem("process",JSON.stringify(t)),n(e.resumeBtn),c(e.pauseBtn),c(e.stopBtn),c(e.lapBtn),l()}function $(){const t=JSON.parse(localStorage.getItem("process")),s=JSON.parse(localStorage.getItem("processes")),a=JSON.parse(localStorage.getItem("log"));t.onPause=!1,e.watch.classList.add("push-watch"),setTimeout(()=>{e.watch.classList.remove("push-watch")},200);const o=Date.now(),r=s.length,L=s.length>0?o-s[r-1].currentTime:o-t.startDate,y={id:g(),step:r+1,user:a.user,time:L,currentTime:o,process:t.name,task:t.steps[r]};s.push(y),localStorage.setItem("processes",JSON.stringify(s)),l()}function M(){const t=JSON.parse(localStorage.getItem("process"));t.onPause=!1,delete t.startDate,localStorage.setItem("process",JSON.stringify(t)),clearInterval(i),i=null,localStorage.setItem("processes","[]"),S(0),l()}function F(){const t=JSON.parse(localStorage.getItem("processes")),s=JSON.parse(localStorage.getItem("allProcesses")),a={id:g(),type:"process-stop-watch",process:t[0].process,items:t};s.push(a),localStorage.setItem("allProcesses",JSON.stringify(s)),localStorage.setItem("processes","[]"),clearTimeout(i),i=null,l()}function j(){document.querySelector("body").style.overflow="hidden",e.hideListBtn.addEventListener("click",C),e.listBackdrop.classList.remove("visually-hidden")}function C(){document.querySelector("body").style.overflow="visible",e.listBackdrop.classList.add("visually-hidden")}function x(t){if(t.target.nodeName!=="BUTTON")return;const s=t.target.id,o=JSON.parse(localStorage.getItem("allProcesses")).filter(r=>r.id!==s);localStorage.setItem("allProcesses",JSON.stringify(o)),setTimeout(()=>{l()},200)}async function W(){e.sendBackdrop.classList.remove("visually-hidden");const t=JSON.parse(localStorage.getItem("allProcesses")),s=[];for(let o of t)o.items.forEach(r=>s.push(r));const a={type:"process-stop-watch",items:s};document.querySelector(".send-btn-wrap").classList.add("visually-hidden");try{const o=await fetch("https://script.google.com/macros/s/AKfycbwQfPNpDsZK7s3qT5Jt8PBS7B2YnK_ILFqPV65fPhuc7J9jd8vJYz4g8oSnoR0GqPSE/exec",{method:"POST",body:JSON.stringify(a)})}catch{p("Oops. Something went wrong.","#")}finally{document.querySelector(".send-btn-wrap").classList.remove("visually-hidden"),e.sendBackdrop.classList.add("visually-hidden")}}
//# sourceMappingURL=commonHelpers4.js.map
